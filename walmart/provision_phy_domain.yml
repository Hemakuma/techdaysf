---
-   name: provisioning physical domain
    hosts: apic
    connection: local
    gather_facts: no

    tasks:
#http://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/2-x/rest_cfg/2_1_x/b_Cisco_APIC_REST_API_Configuration_Guide/b_Cisco_APIC_REST_API_Configuration_Guide_chapter_0101.html
    # Createing vlan pools
        - name: creating the vlan pool template
          template: src=template/createvlanpool.j2 dest=configs/create_vlan_pool.xml

    #creating physical domain
        - name: creating phyical domain template
          template: src=template/createphydomain.j2 dest=configs/create_phydomain.xml

        - name: Applying Vlan pool to APIC
          aci_rest:
              action: post
              uri: /api/mo/uni.xml
              config_file: configs/create_vlan_pool.xml
              username: "{{ user }}"
              password: "{{ passwd }}"
              host: "{{ inventory_hostname }}"

        - name: Applying domain and tie the vlan pool in the APIC
          aci_rest:
              action: post
              uri: /api/mo/uni.xml
              config_file: configs/create_phydomain.xml
              username: "{{ user }}"
              password: "{{ passwd }}"
              host: "{{ inventory_hostname }}"
